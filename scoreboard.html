<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* Add some basic styling for leaderboard entries */
        .leaderboard-entry {
            margin-bottom: 10px;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
    <!-- Include the navbar -->
    <link rel="import" href="/components/navbar.html">
</head>
<body>
    <!-- Use the navbar component -->
    <navbar></navbar>

    <h1>Leaderboard Test</h1>

    <div id="navbar-container"></div>

    <div id="leaderboard-container">
        <!-- Display leaderboard here -->
    </div>

    <script>

        function loadNavbar() {
            const navbarContainer = document.getElementById('navbar-container');
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        navbarContainer.innerHTML = xhr.responseText;
                    } else {
                        console.error('Error loading navbar:', xhr.status);
                    }
                }
            };
            xhr.open('GET', 'components/navbar.html', true);
            xhr.send();
        }



        document.addEventListener('DOMContentLoaded', function () {
            // Make AJAX request to get leaderboard
            loadNavbar();
            getLeaderboard();
        });

        function getLeaderboard() {
            $.ajax({
                url: 'RabbitMQ/dbConsumer.php',
                method: 'GET',
                data: {
                    type: 'getLeaderboard'
                },
                dataType: 'json',
                success: function (response) {
                    displayLeaderboard(response);
                },
                error: function (error) {
                    console.error('Error fetching leaderboard:', error);
                }
            });
        }

        function displayLeaderboard(leaderboard) {
            const leaderboardContainer = document.getElementById('leaderboard-container');
            leaderboardContainer.innerHTML = '';

            if (leaderboard && leaderboard.length > 0) {
                // Displays the leaderboard
                const sectionTitle = document.createElement('h2');
                sectionTitle.textContent = 'Leaderboard';
                leaderboardContainer.appendChild(sectionTitle);

                leaderboard.forEach(entry => {
                    const entryBlock = document.createElement('div');
                    entryBlock.classList.add('leaderboard-entry');
                    entryBlock.innerHTML = `
                        <p>Username: ${entry.Username}</p>
                        <p>Points: ${entry.RateScore}</p>
                        <hr>
                    `;
                    leaderboardContainer.appendChild(entryBlock);
                });
            } else {
                // Handle the case where leaderboard is empty
                console.log('Leaderboard is empty');
                const noLeaderboardMessage = document.createElement('p');
                noLeaderboardMessage.textContent = 'Leaderboard is empty.';
                leaderboardContainer.appendChild(noLeaderboardMessage);
            }
        }
    </script>
</body>
</html>


